# 交差点交通最適化ソリューション

## 概要

本プロジェクトは、都市部の慢性的な交通渋滞と歩行者待ち時間の長さという社会課題を、安価かつ柔軟なエッジ AI プラットフォーム Raspberry Pi 5 と最新の物体検知アルゴリズムを組み合わせて解決することを目的としています。各交差点に設置した小型エッジノードが、車両・歩行者・自転車の通行量をリアルタイムで高精度に計測し、そのデータを基に信号周期・スプリット・オフセットを動的に調整します。さらに複数交差点をクラウドで統合最適化することで、主要導線に沿ったグリーンウェーブを形成し、街区全体の待ち時間と CO₂ 排出を同時に削減します。

従来の ITS では一交差点あたり百万円規模の設備投資が必要でしたが、本ソリューションはエッジ機器一式を八万円以下に抑え、既設 NTCIP 対応信号制御器をそのまま活用できるため、自治体は低予算・短期間で導入可能です。平均赤信号待ち時間二〇％減、年間八万円以上の燃料コスト削減という具体的な効果が見込まれるほか、夜間や悪天候でも IR 照明と専用モデルで検知精度を維持し、通信断時には安全フェールオーバーで固定周期を保持するなど、安全性を担保する仕組みも万全です。

本書では、この価値を最大化するため、ビジネス要件・機能要件・非機能要件を体系的に整理しました。ビジネス要件では平均待ち時間二〇％以上の短縮、年間運用コストを従来比五〇％以下に抑えるなど定量的 KPI を設定。機能要件では二百ミリ秒以内の推論遅延、制御ループ二秒以内、マクロ最適化による延滞時間一五％削減など実装レベルの目標を明確化しています。非機能要件として TLS 一・三による通信暗号化、署名付き OTA、顔領域マスク処理を採用しプライバシーを確保。さらに Mender による差分 OTA と Docker 化により、遠隔でのモデル更新やロールバックを容易にし、大規模展開時の運用負荷を最小化します。

## 1. 目的・背景

都市部の交差点で発生する自動車と歩行者の待ち時間を削減し、交通の流れと安全性を両立させる。Raspberry Pi 5 と物体検知 AI を活用してリアルタイムに交通量を計測し、信号周期を動的に最適化することで、平均待ち時間 20 % 以上削減と CO₂ 排出量低減を目指す。

---

## 2. ビジネス要件

| ID  | 要件                          | 満たすべき指標 (KPI)                             |
| --- | --------------------------- | ----------------------------------------- |
| B‑1 | 交差点群の平均待ち時間を 20 % 以上短縮      | 導入前後での平均赤信号待ち時間の比率 ≤ 0.8                  |
| B‑2 | 歩行者横断の安全性維持                 | 横断中事故ゼロ／ヒヤリハット報告 ≤ 現状                     |
| B‑3 | 年間運用コストを従来 ITS の 50 % 以下に抑制 | 1 交差点あたり CAPEX ≤ ¥80,000、OPEX ≤ ¥15,000/年 |
| B‑4 | CO₂ 排出量削減                   | 惑星保護ロードマップに沿い 5 % 以上削減                    |
| B‑5 | 拡張可能なマクロ最適化                 | 同期制御対象 100 交差点／km² まで水平展開可能               |

### ステークホルダー

* **自治体交通局**（施策決定・費用負担）
* **公安委員会／警察**（信号制御権限）
* **住民・通勤者**（サービス利用者）
* **バス・物流事業者**（優先制御連携）
* **運用ベンダー**（保守・SLA 達成責任）

---

## 3. システム全体構成

```
 カメラ + Raspberry Pi 5  ─┐        ┌─ Control Center (Cloud)
  (Edgeノード)               ├──VPN──┤  • API / DB / 可視化
 カメラ + Raspberry Pi 5  ─┘        └─ 信号制御器 (NTCIP)
```

### 3.1 ハードウェア

| 部位      | 仕様                                             | 備考                                                                                                                                                |
| ------- | ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| エッジノード  | Raspberry Pi 5 8 GB (BCM2712 2.4 GHz Arm A76)  | PoE+ HAT、ヒートシンク付き ([datasheets.raspberrypi.com](https://datasheets.raspberrypi.com/rpi5/raspberry-pi-5-product-brief.pdf?utm_source=chatgpt.com)) |
| カメラ     | Raspberry Pi Global Shutter Camera / HQ Camera | 1080p @ 30 fps、IR カットフィルタ                                                                                                                         |
| AI 推論加速 | Coral USB Edge TPU (任意)                        | YOLOv8 推論 50 fps                                                                                                                                  |
| 通信      | Gigabit Ethernet + LTE/5G フォールバック              | VPN 接続                                                                                                                                            |
| 電源      | AC100 V→PoE+、停電時 UPS 30 分                      | 杆設置用 IP65 防水筐体                                                                                                                                    |

### 3.2 ソフトウェア

* **OS**: Raspberry Pi OS 64‑bit (Kernel 6.x)
* **推論エンジン**: TensorRT / PyTorch‑Mobile
* **検知モデル**: YOLOv8n‑traffic (車両・歩行者・自転車クラス)
* **信号制御 API**: NTCIP 1211 over MQTT/TLS
* **中央最適化**: RL‑based Signal Timing Optimizer (Python, Ray RLlib)
* **監視**: Prometheus + Grafana、OTA 更新 (Mender)

---

## 4. 機能要件

| ID  | 機能              | 詳細                                     | 受入条件                     |
| --- | --------------- | -------------------------------------- | ------------------------ |
| F‑1 | 物体検知            | 1 フレーム ≤ 200 ms で車両/歩行者/自転車を検出・追跡      | 日中検知 F1 ≧ 0.95、夜間 ≧ 0.85 |
| F‑2 | 台数カウント & キュー長推定 | 車線ごとの滞留長 (m) を 1 秒周期で更新                | 誤差 ≤ ±10 %               |
| F‑3 | 単独交差点 最適化       | 相対交通量に応じた信号位相決定 (Cycle, SPLIT, OFFSET) | 平均待ち時間の局所最小化             |
| F‑4 | マクロ最適化          | 周辺 3–5 交差点の同期制御 (グリーンウェーブ)             | 合計延滞時間 15 % 減            |
| F‑5 | ダッシュボード         | Web UI でリアルタイム指標可視化、履歴分析               | レイテンシ ≤ 2 s 更新、7 年分保存    |
| F‑6 | リモート OTA 更新     | ノード OS / AI モデルの差分更新 & ロールバック          | 失敗率 ≤ 1 % │              |
| F‑7 | 異常検知 & 通知       | カメラ画像欠落・温度異常・通信断を検知し通知                 | 検知から通知 ≤ 30 s            |

---

## 5. 非機能要件

### 5.1 性能

* エッジ推論遅延: **≤ 200 ms**／フレーム (1080p, 30 fps 連続ストリーム)
* 制御ループ遅延: **≤ 2 s**（検知→中央集約→新周期設定）

### 5.2 可用性

* ノード稼働率 **99.5 %** 以上（月無停止 219 分以内）
* 中央システム稼働率 **99.9 %**

### 5.3 セキュリティ

* TLS 1.3 によるエンドツーエンド暗号化
* Secure Boot & 署名付き OTA
* 個人特定情報 (顔) を保存しないローカルマスク処理

### 5.4 保守性 / 拡張性

* モジュール化 (Edge ⇆ Cloud is loosely‑coupled via gRPC)
* 新クラス追加時のモデル再学習 & Hot‑swap

---

## 6. 運用・保守

* ノード死活監視: Heartbeat (30 s)
* センサーキャリブレーション: 月次自動キャリブレーションタスク
* 現場交換 MTTR: 2 時間以内 (予備機交換)

---

## 7. リスクと対策

| リスク          | 影響         | 対策                 |
| ------------ | ---------- | ------------------ |
| 夜間・雨天で検知精度低下 | 誤制御による遅延増大 | 夜間専用学習データ／IR 照明追加  |
| ネットワーク断      | 信号同期崩壊     | ローカル安全フェールオーバー周期維持 |
| 法規制 (プライバシー) | 事業停止       | 顔識別禁止、匿名化処理、PIA 実施 |

---

## 8. 投資対効果 (概算)

| 項目         | 金額 (円)                           |
| ---------- | -------------------------------- |
| ハード (1交差点) | 60,000                           |
| 工事・設置      | 25,000                           |
| 年間通信 + 保守  | 12,000                           |
| **ROI**    | 待ち時間減による燃料/CO₂ 削減効果 ≈ 80,000 / 年 |

---

## 9. 依存関係

* NTCIP に準拠した既設信号制御器があること
* 市の光ファイバー / LTE 網への接続許可
* 電柱占有許可・道路占用許可取得

---

## 10. スケジュール

| フェーズ          | 期間                 | マイルストーン          |
| ------------- | ------------------ | ---------------- |
| 調査 & POC      | 2025‑07 \~ 2025‑09 | 1 交差点で推論精度検証完了   |
| パイロット (3 交差点) | 2025‑10 \~ 2026‑01 | KPI B‑1 達成報告書提出  |
| 拡張 (20 交差点)   | 2026‑02 \~ 2026‑06 | マクロ最適化アルゴ実装完了    |
| 市全域展開         | 2026‑07 \~ 2027‑03 | 100 交差点導入、商用稼働開始 |

---

*最終更新: 2025‑06‑03*
